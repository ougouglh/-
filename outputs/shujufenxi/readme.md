C:\ProgramData\anaconda3\python.exe C:\Users\浩浩\PycharmProjects\fugoyuce\utils\fenxi.py
🚀 开始数据分析...
✅ 输出目录已创建: ../outputs
=== 开始加载数据 ===
📊 正在加载训练数据...
✅ 训练数据加载成功: (260864, 3)
💾 基础统计信息已保存: ../outputs\basic_stats.json
👤 正在加载用户信息...
✅ 用户信息加载成功: (424170, 3)
📱 正在加载用户行为日志...
⏳ 检测到大文件，使用分批加载...
加载数据块: 1099it [00:22, 48.87it/s]
✅ 用户行为日志加载成功: (54925330, 7)
🚀 执行快速分析...

==================================================
📊 基础数据分析
==================================================
✅ 数据基本信息:
   总样本数: 260,864
   唯一用户数: 212,062
   唯一商家数: 1,993
   平均每用户关联商家数: 1.23
   平均每商家关联用户数: 130.89

✅ 数据质量检查:
   缺失值情况:
     user_id: 0 (0.00%)
     merchant_id: 0 (0.00%)
     label: 0 (0.00%)
   重复行数: 0

==================================================
🎯 标签分布分析
==================================================
⏳ 正在分析标签分布...
✅ 标签分布:
   标签 0: 244,912 样本 (93.88%)
   标签 1: 15,952 样本 (6.12%)

🎯 关键指标:
   正样本比例: 6.12%
   负样本比例: 93.88%
   ⚠️ 检测到严重的类别不平衡问题！
   💡 建议使用: SMOTE、类别权重、阈值优化等方法
💾 数据已保存: ../outputs\data\label_distribution_analysis.json
📊 图片已保存: ../outputs\plots\label_distribution.png

==================================================
👤 用户行为模式分析
==================================================
⏳ 正在分析用户-商家关联模式...
✅ 用户关联商家数分布:
   关联1个商家的用户: 173,681个 (81.90%)
   关联2个商家的用户: 30,580个 (14.42%)
   关联3个商家的用户: 5,953个 (2.81%)
   关联4个商家的用户: 1,380个 (0.65%)
   关联5个商家的用户: 317个 (0.15%)
   关联6个商家的用户: 100个 (0.05%)
   关联7个商家的用户: 19个 (0.01%)
   关联8个商家的用户: 11个 (0.01%)
   关联9个商家的用户: 5个 (0.00%)
   关联10个商家的用户: 5个 (0.00%)
⏳ 正在计算用户忠诚度指标...

🎯 用户忠诚度洞察:
   单一商家用户: 173,681 (81.90%)
   多商家用户: 38,381 (18.10%)
⏳ 正在分析不同用户群体的重复购买率...
   多商家用户重复购买率: 5.96%
   单商家用户重复购买率: 6.19%
💾 数据已保存: ../outputs\data\user_behavior_analysis.json
💾 数据已保存: ../outputs\data\user_merchant_counts.csv
📊 图片已保存: ../outputs\plots\user_behavior_analysis.png

============================================================
🎯 快速分析总结
============================================================
📊 数据规模: 260,864 样本
⚖️ 正样本比例: 6.12%
👤 单一商家用户比例: 81.9%
⚠️ 严重类别不平衡 - 需要特殊处理
💾 数据已保存: ../outputs\data\quick_analysis_report.json

💾 分析结果已保存到: ../outputs

🎉 分析完成！
📁 请查看 ../outputs 目录获取完整结果

进程已结束，退出代码为 0
